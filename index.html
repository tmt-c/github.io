<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>コンピュータグラフィックス　課題２</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/99/three.min.js"></script>

</head>
<body>
<script>
var init = function() {
	var width = 800,
	height = 600;
  
//レンダラー
	var renderer = new THREE.WebGLRenderer();
	renderer.setSize(width, height);
  document.body.appendChild(renderer.domElement);
  renderer.shadowMapEnabled = true;
  
//シーン
	var scene = new THREE.Scene();
  
//カメラ
  var camera = new THREE.PerspectiveCamera();
  //(45, width / height, 1, 1000);
  camera.position.set( 0, 1, 8 );  
  scene.add( camera );
  
//ネタ
  var geometry = new THREE.BoxGeometry(1.5, 0.2, 0.4);
  var material = new THREE.MeshPhongMaterial({ color: 0xd74950 });
  var neta = new THREE.Mesh(geometry, material);
  neta.castShadow = true;
  neta.position.set( 0, 0.65, 0 );  
//シャリ
  var geometry = new THREE.BoxGeometry(1, 0.3, 0.4);
  var material = new THREE.MeshPhongMaterial({color: 0xe9e8e2});
  var rice = new THREE.Mesh(geometry, material);
  rice.castShadow = true;
  rice.position.set( 0, 0.4, 0 );
//オサラ
  var geometry = new THREE.BoxGeometry(1.2, 0.2, 2);
  var material = new THREE.MeshPhongMaterial({ color: 0xf0c45c });
  var osara = new THREE.Mesh(geometry, material);
  osara.castShadow = true;
  osara.receiveShadow = true;
  osara.position.set( 0, 0.2, 0 );
//足
  var geometry = new THREE.BoxGeometry(0.2, 0.3, 2);
  var material = new THREE.MeshPhongMaterial({ color: 0xf0c45c });
  var leg1 = new THREE.Mesh(geometry, material);
  var leg2 = new THREE.Mesh(geometry, material);
  leg1.castShadow = true;
  leg2.castShadow = true;
  leg1.position.set( -0.3, 0, 0 );
  leg2.position.set( 0.3, 0, 0 );

//ビル
var material = new THREE.SpriteMaterial({
    map: new THREE.TextureLoader().load('https://3.bp.blogspot.com/-kyCggVWkmro/Uku9bVG2B7I/AAAAAAAAYic/El5YLTvXyQs/w1200-h630-p-k-no-nu/tatemono_buildings.png'),
  });

    const bill1 = new THREE.Sprite(material);
    const bill2 = new THREE.Sprite(material);
    const bill3 = new THREE.Sprite(material);
    const bill4 = new THREE.Sprite(material);
    const bill5 = new THREE.Sprite(material);
    bill1.position.set( 1, 0.5, 1.6 );
    bill2.position.set( -0.3, 0.5, -2 );
    bill3.position.set( -1.5, 0.6, -0.4 );
    bill4.position.set( -2, 0.5, 2 );
    bill5.position.set( 1.7, 0.5, -1.7 );
    scene.add(bill1);
    scene.add(bill2);
    scene.add(bill3);
    scene.add(bill4);
    scene.add(bill5);
//地面
var geometry = new THREE.PlaneGeometry(5,5,8,5);
var material = new THREE.MeshPhongMaterial({ color: 0xffffff });
var plane = new THREE.Mesh(geometry, material);
plane.rotation.set( -Math.PI/2, 0, 0 );
plane.position.set( 0, 0, 0 );
plane.receiveShadow = true;
scene.add(plane);

//グループ化
var sushi = new THREE.Object3D();
  sushi.add(rice);
  sushi.add(neta);
  sushi.add(osara);
  sushi.add(leg1);
  sushi.add(leg2);
  sushi.position.set( 0, 0.2, 0, 0);
  scene.add(sushi);

//平行光源
  var light1 = new THREE.DirectionalLight(0x71b5ff);
  light1.position.set(5, 5,30);
  light1.castShadow = true;
  scene.add(light1);
  light1.shadow.mapSize.width = 2048;
  light1.shadow.mapSize.height = 2048;

  var light2 = new THREE.DirectionalLight(0xe1baeb);
  light2.position.set(-30, 20, 20);
  light2.castShadow = true;
  scene.add(light2);
  light2.shadow.mapSize.width = 2048;
  light2.shadow.mapSize.height = 2048;

//初回実行
  var update = function() {
    requestAnimationFrame(update);

//回転
    rice.rotation.y += 0.01;
    neta.rotation.y += 0.01;
    //camera.rocation.z -= 10;
    camera.position.x = 5 * Math.sin(Date.now() / 6000);
    camera.position.z = 5;
    camera.lookAt(new THREE.Vector3(0, 0, 0));
    renderer.render(scene, camera);
  };
  update();
}
  window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>